{% extends "base.html" %}

{% load static %}


{% block head %}
{% endblock %}


{% block content %}
<div class="max-w-xl mx-auto mt-10 p-8 bg-white rounded-2xl shadow-lg">
  <h2 class="text-3xl font-bold mb-6 text-center text-blue-600">BMR & TDEE Calculator</h2>

  <form id="bmr-form" class="space-y-5">
    <!-- Gender -->
    <div>
      <label class="block text-lg font-semibold mb-3 text-center">Select Gender</label>
      <div class="flex justify-center gap-6">
        <label id="male-card"
               class="flex-1 cursor-pointer rounded-xl text-center py-4 transition-all duration-200 hover:scale-105">
          <input type="radio" name="gender" value="male" class="hidden peer" required>
          <div class="peer-checked:bg-blue-500 peer-checked:text-white peer-checked:border-0 rounded-xl py-6 border-2 border-gray-300">
            <div class="text-5xl mb-2">♂️</div>
            <div class="text-xl font-semibold">Male</div>
          </div>
        </label>
        <label id="female-card"
               class="flex-1 cursor-pointer rounded-xl  text-center py-4 transition-all duration-200 hover:scale-105">
          <input type="radio" name="gender" value="female" class="hidden peer">
          <div class="peer-checked:bg-pink-500 peer-checked:text-white peer-checked:border-0 rounded-xl py-6 border-2 border-gray-300">
            <div class="text-5xl mb-2">♀️</div>
            <div class="text-xl font-semibold">Female</div>
          </div>
        </label>
      </div>
    </div>

    <hr class="my-4 border-gray-300">

    <!-- Weight -->
    <div>
      <label class="block text-lg font-semibold mb-1">Weight (kg)</label>
      <input type="number" name="weight"
             class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-400"
             required min="1" placeholder="Enter your weight">
    </div>

    <!-- Height -->
    <div>
      <label class="block text-lg font-semibold mb-1">Height (cm)</label>
      <input type="number" name="height"
             class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-400"
             required min="1" placeholder="Enter your height">
    </div>

    <!-- Age -->
    <div>
      <label class="block text-lg font-semibold mb-1">Age (years)</label>
      <input type="number" name="age"
             class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-400"
             required min="1" placeholder="Enter your age">
    </div>

    <!-- Button -->
    <button type="submit"
            class="w-full bg-blue-500 text-white py-3 rounded-lg text-lg font-semibold hover:bg-blue-600 transition-all duration-200">
      Calculate
    </button>
  </form>

  <hr class="my-4 border-gray-300">

  <!-- Exercise info -->
   <h2 class="mt-5 text-2xl font-bold italic mb-6 text-center text-blue-600">
    You plan to exercise {{ exercise_count }} times this week.
   </h2>
  <div class="mt-5 text-sm text-gray-600 text-center italic">
    
  </div>

  <!-- Results -->
  <div class="grid grid-cols-2 gap-6">
    <!-- BMR -->
    <div class="bg-purple-600 text-white rounded-2xl p-5 shadow-md text-center">
      <div class="text-sm opacity-80 mb-2 font-semibold">BMR <br> (Basal Metabolic Rate)</div>
      <div id="bmr-value"
           class="text-4xl font-bold bg-purple-500 rounded-xl py-4 mb-2">0</div>
      <p class="text-sm opacity-90">Your body’s energy use at complete rest.</p>
    </div>

    <!-- TDEE -->
    <div class="bg-indigo-700 text-white rounded-2xl p-5 shadow-md text-center">
      <div class="text-sm opacity-80 mb-2 font-semibold">TDEE <br> (Total Daily Energy Expenditure)</div>
      <div id="tdee-value"
           class="text-4xl font-bold bg-indigo-600 rounded-xl py-4 mb-2">0</div>
      <p class="text-sm opacity-90">Total calories burned per day including activity.</p>
    </div>
  </div>
</div>

{% endblock %}


{% block script %}
<script>
  document.getElementById('bmr-form').addEventListener('submit', function(e) {
    e.preventDefault();

    const gender = document.querySelector('input[name="gender"]:checked').value;
    const weight = parseFloat(document.querySelector('input[name="weight"]').value);
    const height = parseFloat(document.querySelector('input[name="height"]').value);
    const age = parseInt(document.querySelector('input[name="age"]').value);
    const activityFactor = parseFloat("{{ activity_factor }}");

    let bmr = 0;
    if (gender === 'female') {
      bmr = (655 + (9.6 * weight) + (8 * height)) - (4.7 * age);
    } else {
      bmr = (66 + (13.7 * weight) + (5 * height)) - (8 * age);
    }

    const tdee = bmr * activityFactor;

    document.getElementById('bmr-value').textContent = Math.round(bmr);
    document.getElementById('tdee-value').textContent = Math.round(tdee);
  });
</script>

{% endblock %}
