{% extends "base.html" %}

{% load static %}


{% block head %}
{% endblock %}


{% block content %}
<style>
    .custom-shadow {
        box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
    }
    .glass-effect {
        background: rgba(255, 255, 255, 0.25);
        backdrop-filter: blur(4px);
        -webkit-backdrop-filter: blur(4px);
    }
    .calendar-grid {
        min-width: 2520px;
    }
</style>

<section class="glass-effect rounded-2xl custom-shadow p-10 border border-white border-opacity-30">
<div class="overflow-x-auto">
  <div class="w-full grid grid-cols-2 items-center mb-4 sticky left-0 z-10">
    <div class="text-left">
      <h2 class="font-bold mb-4 sticky left-0 z-10 text-2xl bg-gradient-to-r from-orange-600 to-red-600 bg-clip-text text-transparent">Workout Plan: {{ week_range }}</h2>
    </div>
    <div class="text-right">
      <a href="{% url 'addplan' %}" class="py-2 px-4 bg-green-500 text-white font-semibold rounded-lg hover:bg-green-600 shadow-lg hover:shadow-xl smooth-transition">+ Add New Plan</a>
    </div>
  </div>

  <div class="w-full grid grid-cols-3 items-center mb-4 sticky left-0 z-10">
    <div class="text-left">
      <a href="?week_offset={{ offset|add:-1 }}" class="text-blue-600 hover:underline">← Last Week</a>
    </div>
    <div class="text-center">
      <a href="{% url 'calendar' %}" class="text-blue-600 font-semibold hover:underline">This Week</a>
    </div>
    <div class="text-right">
      <a href="?week_offset={{ offset|add:1 }}" class="text-blue-600 hover:underline">Next Week →</a>
    </div>
  </div>

  <div class="grid grid-cols-[120px_repeat(25,_100px)] calendar-grid">
    <div class="font-bold">Date/Time</div>
    {% for hour in hours %}
      <div class="text-center font-bold">{{ hour }}</div>
    {% endfor %}
  </div>

  {% for date in week_dates %}
    <div class="grid grid-cols-[120px_repeat(24,_100px)] relative border-b calendar-grid">
      <!-- ชื่อวัน -->
      <div class="font-semibold bg-white sticky left-0 z-10 p-2 border-r">
        {{ date|date:"l" }}<br>({{ date|date:"d M Y" }})
      </div>

      <!-- ช่องเวลา -->
      {% for hour in hours %}
        <div class="relative h-16 border-l border-gray-300">
          <!-- เส้นแบ่งชั่วโมง -->
          <div class="absolute inset-y-0 left-0 w-px bg-gray-200"></div>

          {% for activity in plans %}
            {% if activity.day == date.weekday and activity.start_time|date:"H:00" == hour %}
            <a href="{% url 'editplan' activity.id %}">
            {% comment %} <a href="{% url 'home' %}"> {% endcomment %}
              <div class="absolute top-0 h-16 bg-blue-500 hover:bg-blue-600 hover:font-bold text-white text-sm p-1 rounded shadow"
                  style="left: {{ activity.left_px }}px;
                          width: {{ activity.width_px }}px;
                          z-index: 5;">
                {{ activity.workout.name }}<br>
                {{ activity.start_time|date:"H:i" }}–{{ activity.end_time|date:"H:i" }}
              </div>
            </a>
            {% endif %}
          {% endfor %}
        </div>
      {% endfor %}
    </div>
  {% endfor %}

</div>
</section>
{% endblock %}


{% block script %}

{% endblock %}
